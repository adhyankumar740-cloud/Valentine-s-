<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>For Kavya ‚ù§Ô∏è</title>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Cinzel:wght@400;600&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #ff2e63;
      --primary-dark: #c01445;
      --bg-gradient: radial-gradient(circle at 50% 50%, #fff0f5 0%, #ffe3ec 40%, #ffcbd9 100%);
      --glass: rgba(255, 255, 255, 0.65);
      --glass-border: rgba(255, 255, 255, 0.8);
      --text-main: #4a2c36;
      --text-highlight: #d43f65;
      --gold: #eebc51;
      --duo-green: #58cc02; /* Subtle nod to Duolingo */
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; }
    
    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-gradient);
      color: var(--text-main);
      display: flex;
      justify-content: center;
      align-items: center;
      perspective: 1000px;
    }

    /* --- Background Canvas Layers --- */
    canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
    #bg-canvas { z-index: 0; opacity: 0.5; }
    #petals-canvas { z-index: 100; }

    /* --- Main Stage --- */
    .stage {
      position: relative;
      width: 100%;
      max-width: 700px;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }

    /* --- Scenes --- */
    .scene {
      position: absolute;
      width: 90%;
      padding: 40px 30px;
      background: var(--glass);
      backdrop-filter: blur(25px) saturate(180%);
      -webkit-backdrop-filter: blur(25px) saturate(180%);
      border-radius: 24px;
      border: 1px solid var(--glass-border);
      box-shadow: 0 20px 60px rgba(184, 88, 115, 0.15), 
                  0 0 0 1px rgba(255,255,255,0.4) inset;
      text-align: center;
      opacity: 0;
      transform: scale(0.95) translateY(20px);
      pointer-events: none;
      transition: all 1.2s cubic-bezier(0.2, 0.8, 0.2, 1);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 20px;
    }

    .scene.active {
      opacity: 1;
      transform: scale(1) translateY(0);
      pointer-events: auto;
    }

    /* --- Typography --- */
    h1 {
      font-family: 'Playfair Display', serif;
      font-size: 2.2rem;
      margin: 0;
      color: var(--primary-dark);
      line-height: 1.3;
      text-shadow: 0 2px 10px rgba(255, 46, 99, 0.1);
    }

    h2 {
      font-family: 'Great Vibes', cursive;
      font-size: 2.6rem;
      color: var(--text-highlight);
      margin: -5px 0 10px 0;
      font-weight: 400;
    }

    p {
      font-size: 1.05rem;
      line-height: 1.7;
      color: rgba(74, 44, 54, 0.9);
      margin: 0;
      max-width: 500px;
    }

    .gold-text { color: #cc8e35; font-weight: 600; font-style: italic; }
    .highlight { color: var(--primary); font-weight: 600; }

    /* --- Buttons --- */
    .btn {
      padding: 14px 32px;
      border-radius: 50px;
      border: none;
      background: linear-gradient(135deg, #ff4d79, #ff8fa3);
      color: white;
      font-family: 'Cinzel', serif;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      box-shadow: 0 10px 25px rgba(255, 77, 121, 0.3);
      transition: transform 0.3s, box-shadow 0.3s;
      position: relative;
      overflow: hidden;
      letter-spacing: 1px;
    }

    .btn:hover { transform: translateY(-3px); box-shadow: 0 15px 35px rgba(255, 77, 121, 0.4); }
    .btn:active { transform: scale(0.96); }

    .btn.secondary {
      background: transparent;
      border: 2px solid rgba(255, 77, 121, 0.2);
      color: var(--primary);
      box-shadow: none;
    }
    .btn.secondary:hover { background: rgba(255, 77, 121, 0.05); border-color: var(--primary); }

    /* --- Dual Photo Frame --- */
    .photo-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      margin: 10px 0;
      flex-wrap: wrap;
    }

    .polaroid {
      background: white;
      padding: 10px 10px 35px 10px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.1);
      width: 140px;
      height: 180px;
      transition: all 0.5s ease;
      position: relative;
      z-index: 1;
    }
    
    .polaroid img { 
      width: 100%; 
      height: 100%; 
      object-fit: cover; 
      border-radius: 2px;
      filter: sepia(10%);
    }

    .polaroid:first-child { transform: rotate(-6deg); z-index: 2; }
    .polaroid:last-child { transform: rotate(6deg); z-index: 2; }
    
    .polaroid:hover { 
      transform: scale(1.1) rotate(0deg) !important; 
      z-index: 10; 
      box-shadow: 0 20px 50px rgba(255, 46, 99, 0.2);
    }

    .heart-divider {
      font-size: 2rem;
      color: var(--primary);
      animation: pulse-red 2s infinite;
      z-index: 3;
    }

    /* --- Mini Game --- */
    .game-area {
      width: 100%;
      height: 180px;
      background: rgba(255,255,255,0.4);
      border-radius: 12px;
      position: relative;
      overflow: hidden;
      cursor: crosshair;
      border: 1px dashed rgba(255, 46, 99, 0.3);
    }
    .collectible {
      position: absolute;
      font-size: 28px;
      user-select: none;
      animation: floatUp 3.5s linear infinite;
      cursor: pointer;
    }

    /* --- Animations --- */
    @keyframes floatUp { from { transform: translateY(0) rotate(0deg); opacity: 1; } to { transform: translateY(-120px) rotate(20deg); opacity: 0; } }
    @keyframes pulse-red { 0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }
    @keyframes heartbeat { 0% { transform: scale(1); } 15% { transform: scale(1.3); } 30% { transform: scale(1); } 45% { transform: scale(1.15); } 60% { transform: scale(1); } }
    @keyframes sparkle { 0%, 100% { opacity: 0; } 50% { opacity: 1; } }

    /* --- Utility --- */
    .typing-cursor::after { content: '|'; animation: blink 1s infinite; }
    @keyframes blink { 50% { opacity: 0; } }
    
    .overlay {
        position: fixed; inset: 0; background: radial-gradient(circle, transparent 20%, #1a050a 120%); opacity: 0; pointer-events: none; transition: opacity 2s; z-index: 80;
    }
    .overlay.dim { opacity: 0.8; }

    /* Mobile Tweaks */
    @media (max-width: 480px) {
        h1 { font-size: 1.8rem; }
        h2 { font-size: 2rem; }
        .scene { width: 92%; padding: 30px 15px; }
        .polaroid { width: 120px; height: 160px; }
    }
  </style>
</head>
<body>

  <canvas id="bg-canvas"></canvas>
  <canvas id="petals-canvas"></canvas>
  <div class="overlay" id="dimOverlay"></div>

  <div class="stage">
    
    <div id="scene1" class="scene active">
      <div style="font-size: 3.5rem; animation: heartbeat 2s infinite; filter: drop-shadow(0 0 10px rgba(255,46,99,0.4));">‚ù§Ô∏è</div>
      <h1>Happy Valentine's Day</h1>
      <h2>Dearest Kavya</h2>
      <div style="height: 60px; display: flex; align-items: center; justify-content: center;">
        <p id="typewriter" class="typing-cursor" style="font-style: italic; color: #666;"></p>
      </div>
      <button class="btn" onclick="nextScene(1)">Begin Our Story</button>
      <p style="font-size: 0.75rem; opacity: 0.6; margin-top: 15px;">(Tap to start the music)</p>
    </div>

    <div id="scene2" class="scene">
      <h2>1.5 Years of Us</h2>
      
      <div class="photo-container">
        <div class="polaroid">
            <img src="images/adhyan.jpg" alt="me">
            
        </div>
        
        <div class="heart-divider">‚ù§Ô∏è</div>

        <div class="polaroid">
            <img src="images/adhyan.jpg" alt="me">
            
        </div>
      </div>

      <p>"Who knew a language app like <strong>Duolingo</strong> would teach me the most beautiful word ‚Äî <span class="highlight">You</span>."</p>
      <p style="font-size: 0.9rem; margin-top:-10px;">From strangers keeping streaks... to partners keeping promises.</p>
      <button class="btn secondary" onclick="nextScene(2)">Next Chapter</button>
    </div>

    <div id="scene3" class="scene">
      <h2>Unlock My Heart</h2>
      <p>Collect <strong>5 hearts</strong> to reveal the question I've been waiting to ask.</p>
      <div class="game-area" id="gameArea" onclick="spawnTapHeart(event)">
        <div style="position: absolute; top:50%; left:50%; transform:translate(-50%, -50%); color:rgba(0,0,0,0.2);">Catch the flying hearts!</div>
      </div>
      <div style="font-weight: bold; color: var(--primary); font-size: 1.2rem;" id="scoreBoard">0 / 5</div>
    </div>

    <div id="scene4" class="scene">
      <h2>Kavya...</h2>
      <p>It‚Äôs been more than <span class="gold-text">one and a half years</span> together.</p>
      <p>We've shared laughter, silence, and everything in between.</p>
      <p>Every day with you still feels new. You are my favorite notification and my favorite reality.</p>
      <div style="margin-top: 20px;">
        <button class="btn" onclick="startProposal()">Ask the Question</button>
      </div>
    </div>

    <div id="scene5" class="scene">
      <div id="proposal-icon" style="font-size: 4.5rem; filter: drop-shadow(0 0 25px rgba(255,46,99,0.6)); transition: transform 2s;">üíç</div>
      <h1 style="font-size: 2.5rem; margin-top: 10px;">Kavya...</h1>
      <p style="font-size: 1.2rem;">After 1.5 beautiful years...</p>
      <h2 style="font-size: 3rem; margin: 15px 0; color: var(--primary);">Will You Be My Valentine?</h2>
      
      <div style="display: flex; gap: 20px; justify-content: center; width: 100%; margin-top: 30px;">
        <button class="btn" onclick="sheSaidYes()" style="min-width: 140px; font-size: 1.1rem;">YES ‚Äî Always</button>
        <button class="btn secondary" id="noBtn" onmouseover="runAway()" onclick="runAway()" style="min-width: 120px;">Think Again</button>
      </div>
    </div>

    <div id="scene6" class="scene">
      <h1>She Said YES!</h1>
      <p style="font-size: 1.3rem; margin: 20px 0;">This is just the beginning, Kavya ‚ù§Ô∏è</p>
      <div style="font-size: 4rem; animation: heartbeat 1.5s infinite;">üë©‚Äç‚ù§Ô∏è‚Äçüë®</div>
      <p style="font-size: 0.9rem; opacity: 0.7; margin-top: 30px;">(Screen saved in my heart forever)</p>
      <button class="btn secondary" onclick="location.reload()">Replay Our Story</button>
    </div>

  </div>

  <script>
    // --- Configuration ---
    const CONFIG = {
      name: "Kavya",
      introText: "We met learning words... but we learned each other.",
      typingSpeed: 60,
      heartsToWin: 5
    };

    // --- State ---
    let score = 0;
    let audioCtx = null;
    let gameInterval = null;

    // --- DOM Elements ---
    const typewriter = document.getElementById('typewriter');
    const dimOverlay = document.getElementById('dimOverlay');

    // --- Typewriter Effect ---
    let typeIndex = 0;
    function typeWriter() {
      if (typeIndex < CONFIG.introText.length) {
        typewriter.innerHTML += CONFIG.introText.charAt(typeIndex);
        typeIndex++;
        setTimeout(typeWriter, CONFIG.typingSpeed);
      } else {
        typewriter.classList.remove('typing-cursor');
      }
    }
    // Start typing slightly after load
    setTimeout(typeWriter, 1200);

    // --- Scene Transition Logic ---
    function nextScene(n) {
      if (n === 1) initAudio(); // Start audio on first click

      document.getElementById(`scene${n}`).classList.remove('active');
      const next = n + 1;
      
      // Mini Game Trigger
      if (next === 3) startGame();
      
      setTimeout(() => {
        document.getElementById(`scene${next}`).classList.add('active');
      }, 800);
    }

    function startProposal() {
      // Cinematic transition
      dimOverlay.classList.add('dim');
      document.getElementById('scene4').classList.remove('active');
      
      // Play Romantic Chord
      playChord([392.00, 493.88, 587.33, 783.99], 'triangle', 2.5); 

      setTimeout(() => {
        document.getElementById('scene5').classList.add('active');
        spawnSparkles();
      }, 1000);
    }

    function sheSaidYes() {
      dimOverlay.classList.remove('dim'); // Lighten up for celebration
      document.getElementById('scene5').classList.remove('active');
      document.getElementById('scene6').classList.add('active');
      
      // Victory Chord & Effects
      playChord([523.25, 659.25, 783.99, 1046.50], 'sine', 4); 
      startPetalRain();
      burstConfetti();
    }

    // --- The "Runaway No" Button ---
    function runAway() {
      const btn = document.getElementById('noBtn');
      const maxX = window.innerWidth * 0.4;
      const maxY = window.innerHeight * 0.4;
      
      const x = (Math.random() - 0.5) * maxX;
      const y = (Math.random() - 0.5) * maxY;
      
      btn.style.transform = `translate(${x}px, ${y}px)`;
      
      const texts = ["Really?", "Try Again", "Not an option", "Kavya pls", "Look left ->"];
      btn.innerText = texts[Math.floor(Math.random() * texts.length)];
    }

    // --- Mini Game Logic ---
    function startGame() {
      score = 0;
      updateScore();
      const area = document.getElementById('gameArea');
      
      gameInterval = setInterval(() => {
        if(score >= CONFIG.heartsToWin) {
          clearInterval(gameInterval);
          return;
        }
        
        const heart = document.createElement('div');
        heart.innerText = ['‚ù§Ô∏è','üíñ','üåπ'][Math.floor(Math.random()*3)];
        heart.className = 'collectible';
        heart.style.left = (10 + Math.random() * 80) + '%';
        heart.style.top = '100%';
        
        heart.onclick = (e) => {
          e.stopPropagation();
          score++;
          updateScore();
          playTone(800 + (score * 100), 'sine', 0.1); 
          
          // Burst effect on click
          const burst = document.createElement('div');
          burst.style.position = 'absolute';
          burst.style.left = heart.style.left;
          burst.style.top = heart.getBoundingClientRect().top - area.getBoundingClientRect().top + 'px';
          burst.innerText = '+1';
          burst.style.color = '#ff2e63';
          burst.style.fontWeight = 'bold';
          burst.style.transition = 'all 0.5s';
          area.appendChild(burst);
          setTimeout(() => { burst.style.opacity = 0; burst.style.transform = 'translateY(-20px)'; }, 10);
          setTimeout(() => burst.remove(), 500);

          heart.remove();
          
          if(score === CONFIG.heartsToWin) {
            clearInterval(gameInterval);
            setTimeout(() => nextScene(3), 800);
          }
        };

        area.appendChild(heart);
        setTimeout(() => { if(heart.parentElement) heart.remove(); }, 3500);
      }, 700);
    }

    function spawnTapHeart(e) {
      // Visual feedback for missing
      const h = document.createElement('div');
      h.style.position = 'absolute';
      h.style.left = e.offsetX + 'px';
      h.style.top = e.offsetY + 'px';
      h.innerText = '‚ú®';
      h.style.pointerEvents = 'none';
      document.getElementById('gameArea').appendChild(h);
      setTimeout(()=>h.remove(), 500);
    }

    function updateScore() {
      document.getElementById('scoreBoard').innerText = `${score} / ${CONFIG.heartsToWin}`;
    }

    // --- Audio System (Web Audio API) ---
    function initAudio() {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        playAmbientPad();
      } else if (audioCtx.state === 'suspended') {
        audioCtx.resume();
      }
    }

    function playTone(freq, type, duration) {
      if(!audioCtx) return;
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.type = type;
      osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
      gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);
      osc.connect(gain);
      gain.connect(audioCtx.destination);
      osc.start();
      osc.stop(audioCtx.currentTime + duration);
    }

    function playChord(freqs, type, duration) {
        if(!audioCtx) return;
        freqs.forEach((f, i) => {
            setTimeout(() => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = type;
                osc.frequency.value = f;
                gain.gain.setValueAtTime(0, audioCtx.currentTime);
                gain.gain.linearRampToValueAtTime(0.03, audioCtx.currentTime + 0.1);
                gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.start();
                osc.stop(audioCtx.currentTime + duration);
            }, i * 60); 
        });
    }

    function playAmbientPad() {
       const osc = audioCtx.createOscillator();
       const gain = audioCtx.createGain();
       osc.type = 'triangle';
       osc.frequency.value = 110; // A2 Low drone
       gain.gain.setValueAtTime(0, audioCtx.currentTime);
       gain.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 4);
       osc.connect(gain);
       gain.connect(audioCtx.destination);
       osc.start();
    }

    // --- Background Visuals (Canvas) ---
    const canvas = document.getElementById('bg-canvas');
    const ctx = canvas.getContext('2d');
    let width, height;
    let particles = [];

    function resize() {
      width = canvas.width = window.innerWidth;
      height = canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    class Particle {
      constructor() {
        this.x = Math.random() * width;
        this.y = Math.random() * height;
        this.size = Math.random() * 5 + 2;
        this.speedY = Math.random() * 0.4 - 0.2;
        this.speedX = Math.random() * 0.4 - 0.2;
        this.alpha = Math.random() * 0.4;
      }
      update() {
        this.y -= 0.3; // Float up
        this.x += Math.sin(this.y * 0.01) * 0.2;
        if (this.y < 0) this.y = height;
      }
      draw() {
        ctx.fillStyle = `rgba(255, 182, 193, ${this.alpha})`; // Pinkish
        ctx.beginPath();
        // Heart shape approximation for particles
        ctx.font = this.size + "px serif";
        ctx.fillText("‚ù§", this.x, this.y);
      }
    }

    function initParticles() {
      for (let i = 0; i < 40; i++) particles.push(new Particle());
      animateParticles();
    }

    function animateParticles() {
      ctx.clearRect(0, 0, width, height);
      particles.forEach(p => { p.update(); p.draw(); });
      requestAnimationFrame(animateParticles);
    }
    initParticles();

    // --- Petal Rain & Sparkles ---
    const pCanvas = document.getElementById('petals-canvas');
    const pCtx = pCanvas.getContext('2d');
    let petals = [];
    let petalActive = false;

    function startPetalRain() {
        pCanvas.width = window.innerWidth;
        pCanvas.height = window.innerHeight;
        petalActive = true;
        for(let i=0; i<80; i++) {
            petals.push({
                x: Math.random() * pCanvas.width,
                y: Math.random() * pCanvas.height - pCanvas.height,
                size: Math.random() * 15 + 8,
                speed: Math.random() * 2 + 1,
                rotation: Math.random() * 360,
                rotSpeed: Math.random() * 2 - 1,
                color: `rgba(220, 20, 60, ${Math.random()*0.4 + 0.6})`
            });
        }
        animatePetals();
    }

    function animatePetals() {
        if(!petalActive) return;
        pCtx.clearRect(0,0,pCanvas.width, pCanvas.height);
        
        petals.forEach(p => {
            p.y += p.speed;
            p.rotation += p.rotSpeed;
            p.x += Math.sin(p.y * 0.01);
            
            pCtx.save();
            pCtx.translate(p.x, p.y);
            pCtx.rotate(p.rotation * Math.PI / 180);
            pCtx.fillStyle = p.color;
            pCtx.beginPath();
            pCtx.ellipse(0, 0, p.size, p.size/2, 0, 0, Math.PI*2);
            pCtx.fill();
            pCtx.restore();

            if(p.y > pCanvas.height) p.y = -20;
        });
        requestAnimationFrame(animatePetals);
    }

    function spawnSparkles() {
        // Simple sparkle DOM elements around the proposal
        const container = document.getElementById('scene5');
        for(let i=0; i<30; i++) {
            const s = document.createElement('div');
            s.innerHTML = '‚ú®';
            s.style.position = 'absolute';
            s.style.left = Math.random() * 100 + '%';
            s.style.top = Math.random() * 100 + '%';
            s.style.fontSize = (Math.random()*20 + 10) + 'px';
            s.style.animation = `sparkle ${Math.random()*2 + 1}s infinite`;
            s.style.color = '#ffd700';
            s.style.pointerEvents = 'none';
            container.appendChild(s);
        }
    }
    
    function burstConfetti() {
        // Quick visual burst using existing canvas logic
        const colors = ['#ff0000', '#ff69b4', '#ffd700', '#ffffff'];
        for(let i=0; i<100; i++) {
            const el = document.createElement('div');
            el.style.position = 'fixed';
            el.style.left = '50%';
            el.style.top = '50%';
            el.style.width = '10px';
            el.style.height = '10px';
            el.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
            el.style.transform = `translate(-50%, -50%) rotate(${Math.random()*360}deg)`;
            el.style.transition = 'all 1s ease-out';
            el.style.zIndex = '999';
            document.body.appendChild(el);
            
            // Explode
            setTimeout(() => {
                const angle = Math.random() * Math.PI * 2;
                const dist = 100 + Math.random() * 400;
                el.style.transform = `translate(${Math.cos(angle)*dist}px, ${Math.sin(angle)*dist}px) rotate(${Math.random()*360}deg)`;
                el.style.opacity = '0';
            }, 50);
            
            setTimeout(() => el.remove(), 1200);
        }
    }
  </script>
</body>
</html>
